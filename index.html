<!DOCTYPE html><html lang="ja"><head><meta charset="utf-8" /><meta content="IE=edge;chrome=1" http-equiv="X-UA-Compatible" /><meta content="initial-scale=1.0, user-scalable=no" name="viewport" /><title>gameFu's Blog</title><meta description="Site Description" /><link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" /><link href="stylesheets/all-d495412b.css" rel="stylesheet" type="text/css" /><link href="images/favicon-6c3f3d04.png" rel="icon" type="image/png" /></head><body><header><div id="top-menu"><div class="top-menu-wrapper"><div class="top-menu-list"><ul><li><a href="/">Home</a></li><li><a href="/archives/">Archives</a></li><li><a href="/tags/">Tags</a></li><li><a href="/by-year/">By Year</a></li></ul></div><div class="feed"><a href="/feed.xml"><i class="fa fa-rss-square"></i></a></div></div></div><h1 class="logo"><a href="/" title="gameFu's Blog"><span class="logo-text">gameFu's Blog</span></a></h1></header><main><article><h1 class="article-title"><a href="2016/09/14/influxdb/">influxdb continuous query实战总结</a></h1><div class="posted-date-wrapper"><i class="fa fa-clock-o"></i><span class="posted-date">September 14, 2016</span></div><div class="tag-labels"><a href="/tags/influxdb/"><small class="tag-label">influxdb</small></a></div><hr class="article-header-separator" /><h2 id="time-series-database(时序数据库)">Time series Database(时序数据库)</h2>

<p>什么是时间序列数据？最简单的定义就是数据格式里包含timestamp字段的数据。比如股票市场的价格，环境中的温度，主机的CPU使用率等。但是又有什么数据是不包含timestamp的呢？几乎所有的数据都可以打上一个timestamp字段。时间序列数据更重要的一个属性是如何去查询它。在查询的时候，对于时间序列我们总是会带上一个时间范围去过滤数据。同时查询的结果里也总是会包含timestamp字段。</p>

<p>在实际开发使用中，我们或许会有类似这...</p><div class="read-more"><a href="/2016/09/14/influxdb/">Read More <i class="fa fa-angle-double-right"></i></a></div><hr class="article-separator" /><h1 class="article-title"><a href="2016/04/14/nginx-https-and-cors/">nginx https http端口转发 和 cors</a></h1><div class="posted-date-wrapper"><i class="fa fa-clock-o"></i><span class="posted-date">April 14, 2016</span></div><div class="tag-labels"></div><hr class="article-header-separator" /><h3 id="nginx-https配置">nginx https配置</h3>

<p>https的使用需要申请证书，证书需要去专门的CA申请，但是个人网站建议使用免费证书，可以节省不少费用，国内的免费证书申请网站有<a href="https://www.wosign.com/">https://www.wosign.com/</a>。国外的免费证书申请网站有<a href="https://letsencrypt.org/">Let&apos;s Encrypt</a>,但是Let&apos;s Encrypt的免费证书有效期只有90天，如果想长时间使用需要写定时脚本不断更新证书，具体操作可以看<a href="https://imququ.com/post/letsencrypt-certificate.html">这篇博客</a>.</p>

<p>nginx上配置https比较简单只需要拿到crt证书，和证书的私钥在nginx上几行代码就可配置了</p>
<pre class="highlight plaintext"><code>listen...</code></pre><div class="read-more"><a href="/2016/04/14/nginx-https-and-cors/">Read More <i class="fa fa-angle-double-right"></i></a></div><hr class="article-separator" /><h1 class="article-title"><a href="2016/03/15/gitlab_develop_ci/">gitlab_develop_ci</a></h1><div class="posted-date-wrapper"><i class="fa fa-clock-o"></i><span class="posted-date">March 15, 2016</span></div><div class="tag-labels"><a href="/tags/gitlab/"><small class="tag-label">gitlab</small></a><a href="/tags/docker/"><small class="tag-label">docker</small></a></div><hr class="article-header-separator" /><h3 id="使用ci将项目部署到服务器">使用ci将项目部署到服务器</h3>

<h4 id="runner配置">runner配置</h4>

<p>这篇文章中的服务器环境使用的是coreos，部署也是在docker中进行。runner是依然采用了上篇文章中使用的docker-runner执行</p>

<p>在runner服务器上执行下面这段命令，生成执行ci的docker</p>
<pre class="highlight plaintext"><code>docker run -d --name gitlab-runner1 --restart always \
             -v /var/run/docker.sock:/var/run/docker.sock \...</code></pre><div class="read-more"><a href="/2016/03/15/gitlab_develop_ci/">Read More <i class="fa fa-angle-double-right"></i></a></div><hr class="article-separator" /><h1 class="article-title"><a href="2016/03/08/gitlab_and_ci_deploy/">centos7下完整配置gitlab及gitlab-ci docker测试</a></h1><div class="posted-date-wrapper"><i class="fa fa-clock-o"></i><span class="posted-date">March 08, 2016</span></div><div class="tag-labels"><a href="/tags/ruby/"><small class="tag-label">ruby</small></a><a href="/tags/gitlab,-centos-7/"><small class="tag-label">gitlab， centos 7</small></a></div><hr class="article-header-separator" /><h3 id="gitlab下载">gitlab下载</h3>

<p>由于直接从官方渠道下载会遭遇被墙的情况，因此，先更换成中国镜像，再进行下载安装</p>

<p>参照<a href="https://mirror.tuna.tsinghua.edu.cn/help/gitlab-ce/">gitlab中国镜像下载</a></p>

<p>安装完成后运行下面命令，配置gitlab</p>
<pre class="highlight plaintext"><code>gitlab-ctl reconfigure

</code></pre>

<h3 id="gitlab服务">gitlab服务</h3>

<h4 id="开启gitlab服务">开启gitlab服务</h4>
<pre class="highlight plaintext"><code>
gitlab-ctl start

</code></pre>

<h4 id="停止gitlab服务">停止gitlab服务</h4>
<pre class="highlight plaintext"><code>
gitlab-ctl stop

</code></pre>

<h4 id="重启gitlab服务">重启gitlab服务</h4>
<pre class="highlight plaintext"><code>gitlab-ctl restart

</code></pre>

<h4 id="开启rails控制台">开启rails控制台</h4>
<pre class="highlight plaintext"><code>gitlab-rails console...</code></pre><div class="read-more"><a href="/2016/03/08/gitlab_and_ci_deploy/">Read More <i class="fa fa-angle-double-right"></i></a></div><hr class="article-separator" /><h1 class="article-title"><a href="2015/07/09/deploy-docker-passenger-rails-in-coreos/">在coreos上用docker部署rails应用</a></h1><div class="posted-date-wrapper"><i class="fa fa-clock-o"></i><span class="posted-date">July 09, 2015</span></div><div class="tag-labels"><a href="/tags/docker/"><small class="tag-label">docker</small></a><a href="/tags/ruby-on-rails/"><small class="tag-label">ruby on rails</small></a><a href="/tags/coreos/"><small class="tag-label">coreos</small></a></div><hr class="article-header-separator" /><h3 id="coreos上的配置">coreos上的配置</h3>

<p>coreos没有包管理工具，也不鼓励使用包管理工具来解决依赖关系，他提倡使用docker等容易来解决管理以来，要想搭建一个rails的环境，我们需要创建一个能满足我们需求的镜像。docker原则上是一个服务就需要一个镜像，不同的服务之间通讯需要使用docker自己提供的通讯方式，这个演示实例里，我们只依赖于一个数据库服务。首先我们需要创建我们整个rails运行环境所需要的所有服务镜像</p>

<p>postgres数据库的官方镜像</p>
<pre class="highlight shell"><code>
docker pull postgres

</code></pre><div class="read-more"><a href="/2015/07/09/deploy-docker-passenger-rails-in-coreos/">Read More <i class="fa fa-angle-double-right"></i></a></div><hr class="article-separator" /><h1 class="article-title"><a href="2015/07/06/coreos-modify-docker-registry-mirror/">coreos中更改docker镜像地址</a></h1><div class="posted-date-wrapper"><i class="fa fa-clock-o"></i><span class="posted-date">July 06, 2015</span></div><div class="tag-labels"><a href="/tags/docker/"><small class="tag-label">docker</small></a><a href="/tags/coreos/"><small class="tag-label">coreos</small></a></div><hr class="article-header-separator" /><p>由于<code>docker</code>的不断成熟，docker在实际生产环境中的应用已经得到越来越多的印证，因此，公司项目想从原来的Mina部署转为<code>docker</code>部署，但是docker仓库由于在国内没有cdn，导致镜像下载速度无比的缓慢，所以决定换成国内镜像，由于操作系统是使用<code>coreos</code>，无论国内外资料都非常少，因此途中爬了很多坑，这篇文章是我爬坑的总结</p>

<h3 id="docker国内镜像">docker国内镜像</h3>

<p><code>docker</code>是目前炙手可热的云计算开源项目，随着docker不断发展，不久前，国内第一家基于<code>docker</code>技术的一站式容器云平台daocloud...</p><div class="read-more"><a href="/2015/07/06/coreos-modify-docker-registry-mirror/">Read More <i class="fa fa-angle-double-right"></i></a></div><hr class="article-separator" /><h1 class="article-title"><a href="2015/06/22/rails-jwt/">在rails中使用jwt实现授权和权限控制</a></h1><div class="posted-date-wrapper"><i class="fa fa-clock-o"></i><span class="posted-date">June 22, 2015</span></div><div class="tag-labels"><a href="/tags/rails/"><small class="tag-label">rails</small></a></div><hr class="article-header-separator" /><h2 id="关于jwt">关于jwt</h2>

<p><code>JWT</code> 全称<code>json_web_token</code>，是一种高效可靠的数字签名解决标准，它可以携带自定义用户信息，经过 base64 编码, hamc SHA256 加密生成 token, 然后通过 http authorization 请求头传递作为登陆凭证。在<code>RESTful API</code>越来越流行的情况下，传统的cookie, session携带授权令牌很难满足需求了，两者都会带来业务上拓展的困难。</p>

<h2 id="登录流程">登录流程</h2>

<p>首先，用户端会首先检查本地有没有缓存jwt，如果有，直接在请求头上带上jwt...</p><div class="read-more"><a href="/2015/06/22/rails-jwt/">Read More <i class="fa fa-angle-double-right"></i></a></div><hr class="article-separator" /><h1 class="article-title"><a href="2015/06/18/rails-nginx-mina-puma/">Ruby on Rails 终极部署方案 nginx+mina+puma</a></h1><div class="posted-date-wrapper"><i class="fa fa-clock-o"></i><span class="posted-date">June 18, 2015</span></div><div class="tag-labels"><a href="/tags/puma/"><small class="tag-label">puma</small></a><a href="/tags/mina/"><small class="tag-label">mina</small></a><a href="/tags/rails/"><small class="tag-label">rails</small></a></div><hr class="article-header-separator" /><h2 id="搭建工具介绍">搭建工具介绍</h2>

<p><code>Ruby on Rails</code>作为一款十分优秀的web开发框架，在当前web领域中慢慢占据了越来越重要，秉承rails快速开发的特点，很多快速部署rails的方案也越来越多。这篇文章中所选的方案是我个人认为十分优秀的部署方案。这套部署方案的结构是，<code>nginx</code>作为反向代理服务器负责负载均衡，<code>mina</code>作为自动化部署工具，<code>puma</code>作为rails的web服务器</p>

<h3 id="nginx">nginx</h3>

<p><code>nginx</code>是一款优秀的代理服务器，其高效的性能已经得到了业界的广泛认可，相信作为web开发人员不会没听说过他的...</p><div class="read-more"><a href="/2015/06/18/rails-nginx-mina-puma/">Read More <i class="fa fa-angle-double-right"></i></a></div><hr class="article-separator" /><h1 class="article-title"><a href="2015/06/16/laravel-2-login-rewrite/">Laravel(2) 登录重写</a></h1><div class="posted-date-wrapper"><i class="fa fa-clock-o"></i><span class="posted-date">June 16, 2015</span></div><div class="tag-labels"><a href="/tags/laravel/"><small class="tag-label">laravel</small></a><a href="/tags/php/"><small class="tag-label">php</small></a></div><hr class="article-header-separator" /><h3 id="laravel-登录重写">laravel 登录重写</h3>

<p>权限控制是几乎每套成熟系统不可缺少的一部分，我们使用的权限控制方法是rbac，我将在这个系列的文章一步步完成一个比较复杂的rbac权限控制。</p>

<p>rbac权限控制是一个非常成熟的权限控制系统，其原理是给每个用户一个或多个角色 而每个角色对系统相应模块有访问权限,具体理论知识不多介绍。在我完成这个权限控制系统中，我将普通用户和管理员用户分开在数据库中存储，我们先完成普通用户的登录，这一部分相对于管理员用户会比较简单，同时也让大家理解下登录的流程。</p>

<h5 id="未登录用户跳转到登录页面">未登录用户跳转到...</h5><div class="read-more"><a href="/2015/06/16/laravel-2-login-rewrite/">Read More <i class="fa fa-angle-double-right"></i></a></div><hr class="article-separator" /><h1 class="article-title"><a href="2015/06/16/deploy-rails-nginx/">使用passenger在Centos7部署nginx+Ruby on Rails</a></h1><div class="posted-date-wrapper"><i class="fa fa-clock-o"></i><span class="posted-date">June 16, 2015</span></div><div class="tag-labels"><a href="/tags/rails/"><small class="tag-label">rails</small></a></div><hr class="article-header-separator" /><h2 id="passenger">passenger</h2>

<p><code>passenger</code>是一个能快速搭建web环境的工具，它能快速的将<code>nginx</code>和<code>passenger</code>部署到你的服务器中，是部署<code>ruby</code>环境就如同php环境那样简单快速，让人愉悦。下面我将使用这个工具将一个几乎空白的web服务器打造成一个高效的ruby服务器</p>

<h2 id="centos7">centos7</h2>

<p><code>centos7</code>是最新的centos版本带来了一系列新特性，包括对Docker的支持和性能的提高，<a href="http://www.flexense.com/centos6_vs_centos7_nas_performance.html">centos 6和 centos 7性能对比</a></p>

<h2 id="安装ruby环境">安装ruby环境</h2>

<p>首先下载<code>rvm</code>(ruby虚拟机)</p>
<pre class="highlight shell"><code>curl...</code></pre><div class="read-more"><a href="/2015/06/16/deploy-rails-nginx/">Read More <i class="fa fa-angle-double-right"></i></a></div><hr class="article-separator" /><div class="paginate-wrapper"><div class="next-page"><a href="/page/2/"><i class="fa fa-arrow-right"></i> Next Page</a></div></div><div class="page-number">Page 1 of 2</div></article></main><footer><div class="footer-wrapper"><div class="author"><div class="image-wrapper"><a href="/author/"><img alt="author" src="/images/profile-1e71686a.png" /></a></div></div><div class="copyright"><i class="fa fa-copyright"></i> 2016 <a href="/">gameFu's Blog</a> - Site Author</div></div></footer></body></html>